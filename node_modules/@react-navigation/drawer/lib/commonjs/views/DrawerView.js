var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard");Object.defineProperty(exports,"__esModule",{value:true});exports.default=DrawerView;var _toConsumableArray2=_interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));var _defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends"));var React=_interopRequireWildcard(require("react"));var _reactNative=require("react-native");var _reactNativeScreens=require("react-native-screens");var _reactNativeGestureHandler=require("react-native-gesture-handler");var _routers=require("@react-navigation/routers");var _native=require("@react-navigation/native");var _DrawerGestureContext=_interopRequireDefault(require("../utils/DrawerGestureContext"));var _SafeAreaProviderCompat=_interopRequireDefault(require("./SafeAreaProviderCompat"));var _ResourceSavingScene=_interopRequireDefault(require("./ResourceSavingScene"));var _DrawerContent=_interopRequireDefault(require("./DrawerContent"));var _Drawer=_interopRequireDefault(require("./Drawer"));var _DrawerPositionContext=_interopRequireDefault(require("../utils/DrawerPositionContext"));var _jsxFileName="/Users/satya/Workspace/Projects/navigation-ex/packages/drawer/src/views/DrawerView.tsx";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){(0,_defineProperty2.default)(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}var getDefaultDrawerWidth=function getDefaultDrawerWidth(_ref){var height=_ref.height,width=_ref.width;var smallerAxisSize=Math.min(height,width);var isLandscape=width>height;var isTablet=smallerAxisSize>=600;var appBarHeight=_reactNative.Platform.OS==='ios'?isLandscape?32:44:56;var maxWidth=isTablet?320:280;return Math.min(smallerAxisSize-appBarHeight,maxWidth);};var GestureHandlerWrapper=_reactNativeGestureHandler.GestureHandlerRootView!=null?_reactNativeGestureHandler.GestureHandlerRootView:_reactNative.View;function DrawerView(_ref2){var state=_ref2.state,navigation=_ref2.navigation,descriptors=_ref2.descriptors,_ref2$lazy=_ref2.lazy,lazy=_ref2$lazy===void 0?true:_ref2$lazy,_ref2$drawerContent=_ref2.drawerContent,drawerContent=_ref2$drawerContent===void 0?function(props){return React.createElement(_DrawerContent.default,(0,_extends2.default)({},props,{__source:{fileName:_jsxFileName,lineNumber:75}}));}:_ref2$drawerContent,_ref2$drawerPosition=_ref2.drawerPosition,drawerPosition=_ref2$drawerPosition===void 0?_reactNative.I18nManager.isRTL?'right':'left':_ref2$drawerPosition,_ref2$keyboardDismiss=_ref2.keyboardDismissMode,keyboardDismissMode=_ref2$keyboardDismiss===void 0?'on-drag':_ref2$keyboardDismiss,_ref2$overlayColor=_ref2.overlayColor,overlayColor=_ref2$overlayColor===void 0?'rgba(0, 0, 0, 0.5)':_ref2$overlayColor,_ref2$drawerType=_ref2.drawerType,drawerType=_ref2$drawerType===void 0?'front':_ref2$drawerType,_ref2$hideStatusBar=_ref2.hideStatusBar,hideStatusBar=_ref2$hideStatusBar===void 0?false:_ref2$hideStatusBar,_ref2$statusBarAnimat=_ref2.statusBarAnimation,statusBarAnimation=_ref2$statusBarAnimat===void 0?'slide':_ref2$statusBarAnimat,drawerContentOptions=_ref2.drawerContentOptions,drawerStyle=_ref2.drawerStyle,edgeWidth=_ref2.edgeWidth,gestureHandlerProps=_ref2.gestureHandlerProps,minSwipeDistance=_ref2.minSwipeDistance,sceneContainerStyle=_ref2.sceneContainerStyle;var _React$useState=React.useState([state.index]),_React$useState2=(0,_slicedToArray2.default)(_React$useState,2),loaded=_React$useState2[0],setLoaded=_React$useState2[1];var _React$useState3=React.useState(function(){return getDefaultDrawerWidth(_reactNative.Dimensions.get('window'));}),_React$useState4=(0,_slicedToArray2.default)(_React$useState3,2),drawerWidth=_React$useState4[0],setDrawerWidth=_React$useState4[1];var drawerGestureRef=React.useRef(null);var _useTheme=(0,_native.useTheme)(),colors=_useTheme.colors;var isDrawerOpen=Boolean(state.history.find(function(it){return it.type==='drawer';}));var handleDrawerOpen=React.useCallback(function(){navigation.dispatch(_objectSpread({},_routers.DrawerActions.openDrawer(),{target:state.key}));},[navigation,state.key]);var handleDrawerClose=React.useCallback(function(){navigation.dispatch(_objectSpread({},_routers.DrawerActions.closeDrawer(),{target:state.key}));},[navigation,state.key]);React.useEffect(function(){if(isDrawerOpen){navigation.emit({type:'drawerOpen'});}else{navigation.emit({type:'drawerClose'});}},[isDrawerOpen,navigation]);React.useEffect(function(){var subscription;if(isDrawerOpen){subscription=_reactNative.BackHandler.addEventListener('hardwareBackPress',function(){handleDrawerClose();return true;});}return function(){var _subscription;return(_subscription=subscription)==null?void 0:_subscription.remove();};},[handleDrawerClose,isDrawerOpen,navigation,state.key]);React.useEffect(function(){var updateWidth=function updateWidth(_ref3){var window=_ref3.window;setDrawerWidth(getDefaultDrawerWidth(window));};_reactNative.Dimensions.addEventListener('change',updateWidth);return function(){return _reactNative.Dimensions.removeEventListener('change',updateWidth);};},[]);if(!loaded.includes(state.index)){setLoaded([].concat((0,_toConsumableArray2.default)(loaded),[state.index]));}var renderNavigationView=function renderNavigationView(_ref4){var progress=_ref4.progress;return React.createElement(_DrawerPositionContext.default.Provider,{value:drawerPosition,__source:{fileName:_jsxFileName,lineNumber:156}},drawerContent(_objectSpread({},drawerContentOptions,{progress:progress,state:state,navigation:navigation,descriptors:descriptors})));};var renderContent=function renderContent(){return React.createElement(_reactNativeScreens.ScreenContainer,{style:styles.content,__source:{fileName:_jsxFileName,lineNumber:170}},state.routes.map(function(route,index){var descriptor=descriptors[route.key];var unmountOnBlur=descriptor.options.unmountOnBlur;var isFocused=state.index===index;if(unmountOnBlur&&!isFocused){return null;}if(lazy&&!loaded.includes(index)&&!isFocused){return null;}return React.createElement(_ResourceSavingScene.default,{key:route.key,style:[_reactNative.StyleSheet.absoluteFill,{opacity:isFocused?1:0}],isVisible:isFocused,__source:{fileName:_jsxFileName,lineNumber:186}},descriptor.render());}));};var activeKey=state.routes[state.index].key;var gestureEnabled=descriptors[activeKey].options.gestureEnabled;return React.createElement(GestureHandlerWrapper,{style:styles.content,__source:{fileName:_jsxFileName,lineNumber:203}},React.createElement(_SafeAreaProviderCompat.default,{__source:{fileName:_jsxFileName,lineNumber:204}},React.createElement(_DrawerGestureContext.default.Provider,{value:drawerGestureRef,__source:{fileName:_jsxFileName,lineNumber:205}},React.createElement(_Drawer.default,{open:isDrawerOpen,gestureEnabled:gestureEnabled,onOpen:handleDrawerOpen,onClose:handleDrawerClose,onGestureRef:function onGestureRef(ref){drawerGestureRef.current=ref;},gestureHandlerProps:gestureHandlerProps,drawerType:drawerType,drawerPosition:drawerPosition,sceneContainerStyle:[{backgroundColor:colors.background},sceneContainerStyle],drawerStyle:[{width:drawerWidth,backgroundColor:colors.card},drawerStyle],overlayStyle:{backgroundColor:overlayColor},swipeEdgeWidth:edgeWidth,swipeDistanceThreshold:minSwipeDistance,hideStatusBar:hideStatusBar,statusBarAnimation:statusBarAnimation,renderDrawerContent:renderNavigationView,renderSceneContent:renderContent,keyboardDismissMode:keyboardDismissMode,drawerPostion:drawerPosition,__source:{fileName:_jsxFileName,lineNumber:206}}))));}var styles=_reactNative.StyleSheet.create({content:{flex:1}});
//# sourceMappingURL=DrawerView.js.map